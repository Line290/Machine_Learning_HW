\documentclass[UTF8]{ctexart}
\title{ML Homework 2}
\author{林大权 \\ ID: 85610653}
\date{}
\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\usepackage{bm}
\usepackage[colorlinks,linkcolor=red]{hyperref}
\usepackage{amsmath, amsthm, amssymb}
\usepackage{subfloat}
\usepackage{indentfirst}
\leftmargin=0.25in
\oddsidemargin=0.25in
\textwidth=6.0in
\topmargin=-0.25in
\textheight=9.25in

\begin{document}
\maketitle

\begin{description}
\item[1 (1)]: $$Pr(Y_i|\bm{x_i})\sim \mathcal{N}(\bm{x_i^T}\bm{\theta},\sigma ^ 2)$$
$$L_n(\bm{x_i^T}\bm{\theta};y|x) = \prod_{i=1}^{n}f_{Y|x}(y_i|\bm{x_i};\bm{x_i^T}\bm{\theta})$$
log MLE is:
$$l_n(\bm{x_i^T}\bm{\theta};y|x) = \sum_{i=1}^{n}ln\frac{1}{\sigma\sqrt{2\pi}}exp(-\frac{(y_i - \bm{x_i^T}\bm{\theta})^2}{2\sigma^2})$$
$$l_n(\bm{x_i^T}\bm{\theta};y|x) = -\frac{m}{2}ln\sigma^2 - \frac{m}{2}ln(2\pi)-\frac{1}{\sigma^2}\frac{1}{2}||\bm{X}\bm{\theta} - \bm{y}||^2$$
\item[1 (2)]: $\because$ $log(\dot)$ is a monotone function.\\ 
To find the maximum of $l_n(\bm{x_i^T}\bm{\theta};y|x)$ is to find the minimum of $||\bm{X}\bm{\theta} - \bm{y}||^2$

\item[1 (3)]: Because of the square, large errors have relatively greater influence on MSE than do the smaller error. 

\item[2 (1)]: Loss function:
$$J(\bm{\theta}) = \bm{\theta} \bm{X} + b $$
\item[2 (2)]: My termination criterion is $1000$ iterates, each iterate use $1$ samples. And Learning Rate is $0.001$, Regularization Strength is $10^{-5}$. $\sigma = 2$ with Huber Loss Function.
\item[2 (3)]: Convergence result:
$$y = 0.92x + 0.31$$
Fitted curve in fig.1.
\begin{figure}
\centering
        \includegraphics[totalheight=8cm]{p2.png}
    \caption{The fitted curve of GPA.txt in Problem 2.}
    \label{fig:verticalcell}
\end{figure}
the convergence result in fig.2
\begin{figure}
\centering
        \includegraphics[totalheight=8cm]{p2_2.png}
    \caption{The fitted curve of GPA.txt in Problem 2.}
    \label{fig:verticalcell}
\end{figure}
\item[3 (1) (i)]: The linear regression is:
$$ Price = -0.17135Mileage + 24811.9$$
\begin{figure}
\centering
        \includegraphics[totalheight=8cm]{p3_1_1.png}
    \caption{The fitted curve of Mileage vs Price.}
    \label{fig:verticalcell}
\end{figure}
\begin{figure}
\centering
        \includegraphics[totalheight=8cm]{p3_1_2.png}
    \caption{Residuals($y_p - y$) vs the Order of the Data}
    \label{fig:verticalcell}
\end{figure}
\item[3 (1) (ii)]:
Use $R^2$ score:
$$R^2 = 1 - \frac{\sum_i(y_i-f_i)^2}{\sum_i(y_i - \frac{1}{n}\sum_{i=1}^{n}y_i)^2}$$

$R^2 = 0.0204$
\item[3 (1) (iii)]: 
Mileage affect the price, absolutely.\\
Look at Pic.3, the outliers on the above of the plot are all Cadillac XLR-V8, which is more expensive than average. It shows a strong linear relationship with Mileage, which illustrates an important phenomenon: the strength of the relationship can be highly dependent on the set of cases. Also, it can find in Pic.4, the cars are all cluster together.\\
So, Mileage is important to Price.\\
\item[3 (2) (i)]:
\begin{multline}
$$Price = -0.17Mileage +0.39Cylinder -0.10Liter-\\0.15Doors + 0.63Cruise -0.19Sound +0.34Leather + 6097$$
\end{multline}
\item[3 (2) (ii)]:
$R^2 = 0.44$, it's very small than $1$, so it doesn't a good fit.
\item[3 (2) (iii)]:
\begin{multline}
$$In(Price) = -8.2\times10^{-6}Mileage+0.22Liter+0.077Doors+0.017Cruise+\\0.012Sound+0.014Leather+0.096Buick+0.54Cadillac-0.031Chevrolet-\\0.00096Pontiac+0.65SAAB+0.32Convertible-0.20Hatchback-0.16Sedan$$
\end{multline}
$R^2 = 0.952$
\end{description}
\end{document}